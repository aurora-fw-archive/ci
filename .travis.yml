# ┌─┐┬ ┬┬─┐┌─┐┬─┐┌─┐  ┌─┐┬─┐┌─┐┌┬┐┌─┐┬ ┬┌─┐┬─┐┬┌─
# ├─┤│ │├┬┘│ │├┬┘├─┤  ├┤ ├┬┘├─┤│││├┤ ││││ │├┬┘├┴┐
# ┴ ┴└─┘┴└─└─┘┴└─┴ ┴  └  ┴└─┴ ┴┴ ┴└─┘└┴┘└─┘┴└─┴ ┴
# A Powerful General Purpose Framework
# More information in: https://aurora-fw.github.io/
#
# Copyright (C) 2017 Aurora Framework, All rights reserved.

language: cpp

matrix:
    allow_failures:
       - os: osx
    include:
        - os: linux
          compiler: clang
          sudo: required
          env: AURORA_CI_GLFW_VERSION=glfw-x11
        - os: linux
          compiler: gcc
          sudo: required
          env: AURORA_CI_GLFW_VERSION=glfw-x11
        - os: linux
          compiler: clang
          sudo: required
          env: AURORA_CI_GLFW_VERSION=glfw-wayland
        - os: linux
          compiler: gcc
          sudo: required
          env: AURORA_CI_GLFW_VERSION=glfw-wayland
        - os: osx
          compiler: gcc
        - os: osx
          compiler: clang

arch:
  packages:
    - gtk3
    - ninja
    - vulkan-headers
    - $AURORA_CI_GLFW_VERSION
    - glew
    - cmake
    - doxygen
    - repo
  script:
    - yes | repo init -u https://github.com/aurora-fw/manifest.git -b $TRAVIS_BRANCH
    - repo sync
    - sudo repo forall -c git checkout $TRAVIS_BRANCH .
    - if [[ "$TRAVIS_BRANCH" == "dev" ]]; then cmake -DCMAKE_BUILD_TYPE=Debug -DAURORA_BUILD_TEST_APPS=ON .; fi
    - if [[ "$TRAVIS_BRANCH" == "master" ]]; then cmake -DCMAKE_BUILD_TYPE=Release .; fi
    - make && sudo make install
    - make documentation

script:
  - if [[ "$TRAVIS_OS_NAME" == "linux" ]]; then
      curl -s https://raw.githubusercontent.com/aurora-fw/arch-travis/master/arch-travis.sh | bash;
    fi;

notifications:
    email:
        recipients:
            - auroraframework@gmail.com
    on_success: never
    on_failure: always
